var _visibilityCore=function(e){"use strict";var t=-1;var n={onVisible:function(e){var t=n.isSupported();if(!t||!n.hidden()){e();return t}var r=n.change(function(t,i){if(!n.hidden()){n.unbind(r);e()}});return r},change:function(e){if(!n.isSupported()){return false}t+=1;var r=t;n._callbacks[r]=e;n._listen();return r},unbind:function(e){delete n._callbacks[e]},afterPrerendering:function(e){var t=n.isSupported();var r="prerender";if(!t||r!=n.state()){e();return t}var i=n.change(function(t,s){if(r!=s){n.unbind(i);e()}});return i},hidden:function(){return!!(n._doc.hidden||n._doc.webkitHidden)},state:function(){return n._doc.visibilityState||n._doc.webkitVisibilityState||"visible"},isSupported:function(){return!!(n._doc.visibilityState||n._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(e){var t=n.state();for(var r in n._callbacks){n._callbacks[r].call(n._doc,e,t)}},_listen:function(){if(n._init){return}var e="visibilitychange";if(n._doc.webkitVisibilityState){e="webkit"+e}var t=function(){n._change.apply(n,arguments)};if(n._doc.addEventListener){n._doc.addEventListener(e,t)}else{n._doc.attachEvent(e,t)}n._init=true}};e.Visibility=n};_visibilityCore(window);var _visibilityFallback=function(e){"use strict";if(e.visibilityState||e.webkitVisibilityState){return}e.hidden=false;e.visibilityState="visible";var t=null;var n=0;var r=function(){if(e.createEvent){if(!t){t=e.createEvent("HTMLEvents");t.initEvent("visibilitychange",true,true)}e.dispatchEvent(t)}else{if(typeof Visibility=="object"){Visibility._change.call(Visibility,{})}}};var i=function(){e.hidden=false;e.visibilityState="visible";r()};var s=function(){e.hidden=true;e.visibilityState="hidden";r()};if(e.addEventListener){window.addEventListener("focus",i,true);window.addEventListener("blur",s,true)}else{e.attachEvent("onfocusin",i);e.attachEvent("onfocusout",s)}};_visibilityFallback(document)